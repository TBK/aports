# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=alpine
pkgver=2.21.99
_githash=04737118aa1d9ad3db63fb1064267187ae871856
pkgrel=1
pkgdesc="Text-based email client, friendly for novices but powerful"
url="http://repo.or.cz/alpine.git"
arch="all"
license="Apache-2.0"
depends=""
makedepends="openldap-dev heimdal-dev ncurses-dev libressl-dev
	automake autoconf libtool"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::http://repo.or.cz/alpine.git/snapshot/${_githash}.tar.gz
	uclibc-musl.patch
	"
builddir="$srcdir"/$pkgname-${_githash:0:7}

prepare() {
	cd "$builddir"
	default_prepare
	libtoolize --force && aclocal -I m4 && autoconf \
		&& automake --force --add-missing
}

build() {
	cd "$builddir"
	./configure \
		--build="$CBUILD" \
		--host="$CHOST" \
		--prefix=/usr \
		--with-passfile=.pine-pass \
		--without-tcl \
		--disable-shared \
		--with-system-pinerc=/etc/alpine.d/pine.conf \
		--with-system-fixed-pinerc=/etc/alpine.d/pine.conf.fixed
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
}

sha512sums="56ad62b6f096c55e3c7200802ee030a2dc24f31bfc9f779f1fdb1360d713403b8a1a9cb13602365a85bb0b894be79fcc227106729a828f16b7cf9c58637eba00  alpine-2.21.99.tar.gz
c483ca687e81057d5dc8ebd0319db3445b13cffcc252d823ae555caff1ca0bf276185e4cf131e6302180c4637b3d19368cda9d26246811b6ea76c24a946ab5d0  uclibc-musl.patch"
